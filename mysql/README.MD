# SQL建议

- 能用单表优先用单表，即便是需要用group by、order by、limit等，效率一般也比多表高
- 不能用单表时优先用连接，连接是SQL中非常强大的用法，小表驱动大表+建立合适索引+合理运用连接条件，基本上连接可以解决绝大部分问题。但join级数不宜过多，毕竟是一个接近指数级增长的关联效果
- 能不用子查询、笛卡尔积尽量不用，虽然很多情况下MySQL优化器会将其优化成连接方式的执行过程，但效率仍然难以保证
- 自定义变量在复杂SQL实现中会很有用，例如LeetCode中困难级别的数据库题目很多都需要借助自定义变量实现
- 如果MySQL版本允许，某些带聚合功能的查询需求应用窗口函数是一个最优选择。除了经典的获取3种排名信息，还有聚合函数、向前向后取值、百分位等，具体可参考官方指南。以下是官方给出的几个窗口函数的介绍：
  - CUME_DIST
  - DENSE_RANK
  - FIRST_VALUE
  - LAG
  - LAST_VALUE
  - NTH_VALUE
  - NTILE
  - PERCENT_RANK
  - RANK
  - ROW_NUMBER
  - 